# FLP impossibility result

FLP不可能性定理。这个定理的核心内容是：

**在异步分布式系统中，即使只有一个进程可能发生故障（崩溃故障），也不可能实现确定性的共识算法。**

FLP不可能性定理揭示了在异步分布式系统中，达成一致共识的困难。它表明，在不做额外假设（如部分同步、故障检测器的准确性等）的情况下，我们不能保证所有正确的进程总是能够在有限时间内就某个值达成共识。

### FLP不可能性结果的总结

1. **双价性初始化引理（Bivalent Initialization Lemma）**：
   - 存在一个双价性的（无故障）初始配置。双值初始化引理表明，在没有故障的初始配置中，存在一个所谓的“双值”配置。在双值配置中，系统可以进入两种可能的最终状态（比如在共识问题中，这两种状态可以是决定值0或1）。这意味着系统的最初状态是不确定的，即无法预先确定系统将最终进入哪种状态。

2. **扩展引理（Extension Lemma）**：
   - 从任何双价性的无故障配置`C`出发，总能到达另一个双价性的无故障配置`C'`。这意味着，无论系统执行了多少步操作，总有可能保持在一个双值状态，即系统可以继续保持这种不确定性。

3. **因此，共识永远不会终止**：
   - 结合这两个引理，我们可以得出结论：在一个完全异步的系统中，如果允许进程故障，就无法保证总是能够达成共识。因为总是存在一条路径，沿着这条路径系统保持在双值状态，即使经过任意多的步骤，系统也无法决定一个特定的最终状态。

### FLP不适用的情况

1. **时间假设**：包括故障检测器和同步性。在部分同步或完全同步的系统中，可以规避FLP的限制。
2. **没有可能的故障**：如果系统中不允许任何进程失败，FLP的限制不适用。
3. **随机化**：在某些情况下，使用随机化技术可以提供概率上的共识保证。

规避FLP的方法

1. **故障检测器**：
   - 例如P、→P、Ω等故障检测器。通过引入关于进程故障和恢复的额外信息，可以帮助系统在特定条件下达成共识。

2. **概率保证**：
   - 通过随机化算法，共识的属性可以以一定概率得到保证。

3. **确定性算法的局限性**：
   - FLP不可能性结果适用于确定性算法。对于概率性或随机化算法，FLP的限制可能不适用。通过引入随机性，算法可以在期望意义上绕过FLP限制，即使在一个异步系统中也能以高概率达成共识。

FLP不可能性结果是对分布式系统共识能力的一个重要限制，但在实际应用中，通过引入时间假设、故障检测器、随机化等技术，可以在一定程度上规避这些限制。这些方法在分布式系统的设计和实现中非常关键，帮助系统在不完美的网络环境和存在进程故障的情况下达成共识。

# Randomized Consensus

## Common Coin

在解决共识问题时。共同硬币通常用于提供随机化决策的机制，特别是在那些需要规避FLP不可能性结果的分布式算法中。这个机制可以帮助保证算法的活性，即使在异步环境下也能够达成共识。

### 属性

1. **终止（Termination）**：每个正确的进程最终都会输出一个硬币值。
   
2. **不可预测性（Unpredictability）**：在至少一个正确的进程释放硬币之前，没有任何进程能够获得关于由正确进程输出的硬币值的任何信息。
   
3. **匹配（Matching）**：至少有δ的概率，每个正确的进程输出相同的硬币值。
   
4. **无偏差（No Bias）**：如果所有正确的进程输出相同的硬币值，那么硬币在B上的分布是均匀的（即匹配的硬币以1/#(B)的概率输出B中的任何值）。

### 可能的共同硬币实现

1. **本地抛硬币（Local Toss）算法**：
   - 当释放硬币时，每个进程从D中随机选择一个值`c`，并按均匀分布输出`c`。如果域是一个比特，那么这实现了一个δ=2-N+1匹配的共同硬币。选择相同的`c∈{0,1}`的概率是2^(-N)。
2. **信标算法（Beacon Algorithm）**：
   - 稍微作弊：使用外部进程，不完全分布式。可信第三方
   - 一个外部可信进程（信标）定期选择一个不可预测的随机值。
   - 当算法需要一系列共同硬币时，对于第k个硬币，每个进程从信标接收第k个随机值并输出它。
   - 这种硬币总是匹配（δ=1）。
3. **门限签名方案（Threshold Signature Scheme）**：
   - 也可以实现δ=1的匹配硬币。

共同硬币在解决共识问题，特别是在概率共识算法中非常有用。它提供了一种方式，以使所有正确的进程以高概率做出相同的随机决策，即使在存在不确定性和潜在故障的分布式系统中。通过使用共同硬币，分布式算法能够在不完美的环境中达到共识，特别是在考虑FLP不可能性结果时。